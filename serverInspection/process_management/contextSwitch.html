<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>컨텍스트 스위칭 점검 명령어</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f4f6f8;
      line-height: 1.6;
      color: #1f2a37;
    }
    h1, h2, h3 {
      color: #2c3e50;
    }
    .section {
      background: #ffffff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    code {
      background: #eef2f7;
      padding: 3px 6px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.95em;
    }
    pre {
      background: #eef2f7;
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
    }
    ul {
      margin-left: 20px;
    }
  </style>
</head>
<body>

<h1>컨텍스트 스위칭(Context Switching) 점검 명령어</h1>

<div class="section">
  <h2>1) 시스템 전체 컨텍스트 스위치 확인</h2>

  <h3>vmstat (초당 context switch)</h3>
  <pre><code>vmstat 1</code></pre>
  <ul>
    <li><code>cs</code> 컬럼 → 초당 context switch 횟수</li>
  </ul>

  <h3>/proc/stat (누적 값)</h3>
  <pre><code>grep -E '^ctxt' /proc/stat</code></pre>
  <ul>
    <li><code>ctxt</code> → 부팅 이후 누적 context switch</li>
  </ul>
</div>

<div class="section">
  <h2>2) 프로세스별 컨텍스트 스위치 확인</h2>

  <h3>pidstat (전체 프로세스)</h3>
  <pre><code>pidstat -w 1</code></pre>
  <ul>
    <li><code>nvcsw/s</code> → 자발적 context switch</li>
    <li><code>nivcsw/s</code> → 비자발적 context switch</li>
  </ul>

  <h3>특정 PID만 확인</h3>
  <pre><code>pidstat -w -p 1234 1</code></pre>
</div>

<div class="section">
  <h2>3) 스레드별 컨텍스트 스위치</h2>

  <h3>모든 스레드</h3>
  <pre><code>pidstat -w -t 1</code></pre>

  <h3>특정 PID의 스레드</h3>
  <pre><code>pidstat -w -t -p 1234 1</code></pre>
</div>

<div class="section">
  <h2>4) perf를 이용한 커널 레벨 확인</h2>

  <h3>시스템 전체 통계</h3>
  <pre><code>perf stat -e context-switches,cpu-migrations,page-faults -a -- sleep 10</code></pre>

  <h3>스케줄 이벤트 기록</h3>
  <pre><code>perf sched record -- sleep 10
perf sched latency</code></pre>
</div>

<div class="section">
  <h2>5) 보조 확인 (top)</h2>
  <pre><code>top</code></pre>
  <ul>
    <li>Tasks 수</li>
    <li>Load Average</li>
    <li>%wa (I/O wait)</li>
  </ul>
</div>

<div class="section">
  <h2>실무에서 자주 쓰는 3가지</h2>
  <pre><code>vmstat 1
pidstat -w 1
perf stat -e context-switches -a -- sleep 10</code></pre>
</div>

</body>
</html>
